{% extends 'shop/base.html' %}
{% load static %}

{% block title %}Главная — Shop#1{% endblock %}

{% block content %}

<!-- Hero Section -->
<section id="hero" class="hero d-flex align-items-center">
  <div class="container text-center" data-aos="fade-up">
    <h2>Добро пожаловать в <span>Shop#1</span></h2>
    <p>Выберите категорию или просмотрите популярные товары.</p>
  </div>
</section>

<!-- Categories Section -->
<section id="categories" class="categories mt-5">
  <div class="container" data-aos="fade-up">
    <div class="section-title"><h2>Категории</h2></div>
    <div class="row" id="category-list"></div>
  </div>
</section>

<!-- Products Section -->
<section id="products" class="products mt-5">
  <div class="container" data-aos="fade-up">
    <div class="section-title"><h2>Популярные товары</h2></div>
    <div class="row gy-4" id="product-list"></div>
  </div>
</section>

{% endblock %}

{% block scripts %}
<script>
const STATIC_NO_IMAGE = "{% static 'shop/assets/img/no_image.png' %}";

async function loadCategories() {
  try {
    const res = await fetch('/api/categories/');
    const data = await res.json();
    const el = document.getElementById('category-list');
    el.innerHTML = data.map(cat => `
      <div class="col-lg-3 col-md-4 col-6 d-flex align-items-stretch">
        <div class="card text-center shadow-sm">
          <div class="card-body">
            <h5 class="card-title">${cat.name}</h5>
          </div>
        </div>
      </div>
    `).join('');
  } catch (e) { console.error(e); }
}

async function loadProducts() {
  try {
    const res = await fetch('/api/products/');
    const data = await res.json();
    const el = document.getElementById('product-list');
    el.innerHTML = data.map(p => `
      <div class="col-lg-3 col-md-6">
        <div class="product-item card h-100 shadow-sm">
          <a href="/product/${p.id}/">
            <img src="${p.image || STATIC_NO_IMAGE}" class="img-fluid" alt="${p.name}">
          </a>
          <div class="text-center mt-3">
            <h5>${p.name}</h5>
            <p class="text-muted">${p.price} ₽</p>
          </div>
        </div>
      </div>
    `).join('');
  } catch (e) { console.error(e); }
}

loadCategories();
loadProducts();
</script>
{% endblock %}
